"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[866],{4889:function(t,e,a){a.d(e,{EvmAdapter:function(){return l}});var r=a(7021);let s={name:"deposit",type:"function",stateMutability:"payable",inputs:[{name:"asset",type:"address"},{name:"to",type:"address"},{name:"amount",type:"uint256"},{name:"proofData",type:"bytes"}],outputs:[]},o={name:"withdraw",type:"function",stateMutability:"nonpayable",inputs:[{name:"asset",type:"address"},{name:"to",type:"address"},{name:"amount",type:"uint256"},{name:"proofData",type:"bytes"},{name:"disclosureHash",type:"bytes32"}],outputs:[]};function n(t){return"0x0000000000000000000000000000000000000000"}var i=a(6434).Buffer;class l{async init(t){this.providerUrl=t.rpcUrl}async rpc(t){var e;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!this.providerUrl)throw Error("EvmAdapter not initialized");let r={jsonrpc:"2.0",id:this.idCounter++,method:t,params:a},s=await fetch(this.providerUrl,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(r)});if(!s.ok)throw Error("RPC HTTP ".concat(s.status));let o=await s.json();if(o.error)throw Error(null!==(e=o.error.message)&&void 0!==e?e:"RPC error");return o.result}async getBalance(t,e){if(!e)return BigInt(await this.rpc("eth_getBalance",[t,"latest"])).toString();if(e.startsWith("0x")&&42===e.length){let a="0x70a08231"+t.toLowerCase().replace(/^0x/,"").padStart(64,"0");return BigInt(await this.rpc("eth_call",[{to:e,data:a},"latest"])).toString()}return"0"}async deposit(t){return function(t){let e=n(t.assetSymbol),a=t.to,o=t.proofData;return o.startsWith("0x")||(o="0x".concat(o)),(0,r.R)({abi:[s],functionName:"deposit",args:[e,a,t.amount,o]})}({assetSymbol:t.assetSymbol,to:t.address,amount:BigInt(t.amount),proofData:t.proof.proofData})}async withdraw(t){var e,a;let s;if(null===(e=t.disclosure)||void 0===e?void 0:e.enableSelectiveDisclosure){if(t.disclosure.disclosureHash)s=t.disclosure.disclosureHash;else{null===(a=t.disclosure.scope)||void 0===a||a.join(",");let e=JSON.stringify({scope:t.disclosure.scope,timestamp:Date.now()});s="0x".concat(i.from(e).toString("hex").slice(0,64).padEnd(64,"0"))}}return function(t){let e=n(t.assetSymbol),a=t.to,s=t.proofData;s.startsWith("0x")||(s="0x".concat(s));let i=t.disclosureHash||"0x0000000000000000000000000000000000000000000000000000000000000000";return i.startsWith("0x")||(i="0x".concat(i)),i.length<66&&(i="0x".concat(i.slice(2).padStart(64,"0"))),(0,r.R)({abi:[o],functionName:"withdraw",args:[e,a,t.amount,s,i]})}({assetSymbol:t.assetSymbol,to:t.address,amount:BigInt(t.amount),proofData:t.proof.proofData,disclosureHash:s})}constructor(){this.idCounter=1}}}}]);